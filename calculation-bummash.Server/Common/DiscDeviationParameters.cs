using calculation_bummash.Server.Models.Deviation;

namespace calculation_bummash.Server.Common.DiscDeviationParameters
{
    public static class DiscDeviationParameters
    {
        public static Deviation? FirstOrThrow(int discDiameter, int height) =>
            DiscDeviationList.FirstOrDefault(x => x.Contains(discDiameter, height));

        private static readonly HashSet<Deviation> DiscDeviationList =
        [
            new(100, 150, 0, 500, 24, 9),
            new(150, 200, 0, 500, 24, 9),
            new(200, 250, 0, 500, 25, 9),
            new(250, 315, 0, 500, 27, 10),
            new(315, 400, 0, 500, 28, 10),
            new(400, 500, 0, 500, 29, 11),
            new(500, 630, 0, 500, 30, 11),
            new(100, 150, 500, 630, 25, 9),
            new(150, 200, 500, 630, 25, 9),
            new(200, 250, 500, 630, 26, 9),
            new(250, 315, 500, 630, 28, 10),
            new(315, 400, 500, 630, 29, 11),
            new(400, 500, 500, 630, 30, 11),
            new(500, 630, 500, 630, 31, 11),
            new(630, 800, 500, 630, 33, 12),
            new(100, 150, 630, 800, 27, 10),
            new(150, 200, 630, 800, 27, 10),
            new(200, 250, 630, 800, 28, 10),
            new(250, 315, 630, 800, 30, 11),
            new(315, 400, 630, 800, 31, 11),
            new(400, 500, 630, 800, 31, 11),
            new(500, 630, 630, 800, 33, 12),
            new(630, 800, 630, 800, 36, 13),
            new(800, 1000, 630, 800, 37, 14),
            new(150, 200, 800, 1000, 29, 11),
            new(200, 250, 800, 1000, 30, 11),
            new(250, 315, 800, 1000, 32, 12),
            new(315, 400, 800, 1000, 33, 12),
            new(400, 500, 800, 1000, 34, 13),
            new(500, 630, 800, 1000, 35, 13),
            new(630, 800, 800, 1000, 38, 14),
            new(800, 1000, 800, 1000, 40, 15),
            new(1000, 1250, 800, 1000, 44, 16),
            new(150, 200, 1000, 1250, 31, 11),
            new(200, 250, 1000, 1250, 32, 12),
            new(250, 315, 1000, 1250, 34, 13),
            new(315, 400, 1000, 1250, 35, 13),
            new(400, 500, 1000, 1250, 36, 13),
            new(500, 630, 1000, 1250, 37, 14),
            new(630, 800, 1000, 1250, 41, 15),
            new(800, 1000, 1000, 1250, 43, 16),
            new(1000, 1250, 1000, 1250, 46, 17),
            new(1250, 1400, 1000, 1250, 47, 18),
            new(1400, 1600, 1000, 1250, 48, 18),
            new(150, 200, 1250, 1400, 35, 13),
            new(200, 250, 1250, 1400, 36, 13),
            new(250, 315, 1250, 1400, 38, 14),
            new(315, 400, 1250, 1400, 40, 15),
            new(400, 500, 1250, 1400, 41, 15),
            new(500, 630, 1250, 1400, 43, 16),
            new(630, 800, 1250, 1400, 46, 17),
            new(800, 1000, 1250, 1400, 48, 18),
            new(1000, 1250, 1250, 1400, 52, 20),
            new(1250, 1400, 1250, 1400, 54, 20),
            new(1400, 1600, 1250, 1400, 56, 21),
            new(1600, 1800, 1250, 1400, 58, 22),
            new(200, 250, 1400, 1600, 38, 14),
            new(250, 315, 1400, 1600, 41, 15),
            new(315, 400, 1400, 1600, 42, 16),
            new(400, 500, 1400, 1600, 44, 16),
            new(500, 630, 1400, 1600, 46, 17),
            new(630, 800, 1400, 1600, 50, 19),
            new(800, 1000, 1400, 1600, 52, 20),
            new(1000, 1250, 1400, 1600, 56, 21),
            new(1250, 1400, 1400, 1600, 58, 22),
            new(1400, 1600, 1400, 1600, 60, 23),
            new(1600, 1800, 1400, 1600, 63, 23),
            new(1800, 2000, 1400, 1600, 54, 23),
            new(250, 315, 1600, 1800, 40, 15),
            new(315, 400, 1600, 1800, 44, 16),
            new(400, 500, 1600, 1800, 48, 17),
            new(500, 630, 1600, 1800, 50, 18),
            new(630, 800, 1600, 1800, 54, 19),
            new(800, 1000, 1600, 1800, 56, 20),
            new(1000, 1250, 1600, 1800, 60, 21),
            new(1250, 1400, 1600, 1800, 62, 23),
            new(1400, 1600, 1600, 1800, 65, 24),
            new(1600, 1800, 1600, 1800, 67, 25),
            new(1800, 2000, 1600, 1800, 68, 25),
            new(2000, 2250, 1600, 1800, 69, 26),
            new(250, 315, 1800, 2000, 47, 18),
            new(315, 400, 1800, 2000, 49, 19),
            new(400, 500, 1800, 2000, 51, 19),
            new(500, 630, 1800, 2000, 53, 20),
            new(630, 800, 1800, 2000, 57, 21),
            new(800, 1000, 1800, 2000, 59, 22),
            new(1000, 1250, 1800, 2000, 64, 24),
            new(1250, 1400, 1800, 2000, 67, 25),
            new(1400, 1600, 1800, 2000, 69, 26),
            new(1600, 1800, 1800, 2000, 73, 27),
            new(1800, 2000, 1800, 2000, 75, 28),
            new(2000, 2250, 1800, 2000, 76, 28),
            new(2250, 2500, 1800, 2000, 82, 30),
            new(250, 315, 2000, 2250, 51, 18),
            new(315, 400, 2000, 2250, 53, 19),
            new(400, 500, 2000, 2250, 55, 19),
            new(500, 630, 2000, 2250, 57, 20),
            new(630, 800, 2000, 2250, 61, 21),
            new(800, 1000, 2000, 2250, 63, 22),
            new(1000, 1250, 2000, 2250, 68, 24),
            new(1250, 1400, 2000, 2250, 72, 25),
            new(1400, 1600, 2000, 2250, 75, 26),
            new(1600, 1800, 2000, 2250, 79, 27),
            new(1800, 2000, 2000, 2250, 81, 28),
            new(2000, 2250, 2000, 2250, 82, 28),
            new(2250, 2500, 2000, 2250, 85, 30),
            new(315, 400, 2250, 2500, 57, 21),
            new(400, 500, 2250, 2500, 59, 22),
            new(500, 630, 2250, 2500, 61, 23),
            new(630, 800, 2250, 2500, 65, 25),
            new(800, 1000, 2250, 2500, 68, 26),
            new(1000, 1250, 2250, 2500, 74, 28),
            new(1250, 1400, 2250, 2500, 78, 29),
            new(1400, 1600, 2250, 2500, 81, 30),
            new(1600, 1800, 2250, 2500, 85, 33),
            new(1800, 2000, 2250, 2500, 87, 34),
            new(2000, 2250, 2250, 2500, 88, 34),
            new(2250, 2500, 2250, 2500, 91, 35),
            new(315, 400, 2500, 2800, 61, 23),
            new(400, 500, 2500, 2800, 63, 24),
            new(500, 630, 2500, 2800, 65, 25),
            new(630, 800, 2500, 2800, 71, 27),
            new(800, 1000, 2500, 2800, 74, 28),
            new(1000, 1250, 2500, 2800, 81, 30),
            new(1250, 1400, 2500, 2800, 83, 31),
            new(1400, 1600, 2500, 2800, 87, 34),
            new(1600, 1800, 2500, 2800, 91, 35),
            new(1800, 2000, 2500, 2800, 92, 36),
            new(2000, 2250, 2500, 2800, 94, 37),
            new(2250, 2500, 2500, 2800, 97, 38),
            new(400, 500, 2800, 3150, 67, 25),
            new(500, 630, 2800, 3150, 69, 26),
            new(630, 800, 2800, 3150, 77, 29),
            new(800, 1000, 2800, 3150, 80, 30),
            new(1000, 1250, 2800, 3150, 86, 33),
            new(1250, 1400, 2800, 3150, 89, 34),
            new(1400, 1600, 2800, 3150, 93, 36),
            new(1600, 1800, 2800, 3150, 97, 38),
            new(1800, 2000, 2800, 3150, 98, 38),
            new(2000, 2250, 2800, 3150, 100, 40),
            new(2250, 2500, 2800, 3150, 100, 41),
            new(400, 500, 3150, 3500, 71, 27),
            new(500, 630, 3150, 3500, 75, 28),
            new(630, 800, 3150, 3500, 83, 31),
            new(800, 1000, 3150, 3500, 86, 33),
            new(1000, 1250, 3150, 3500, 92, 36),
            new(1250, 1400, 3150, 3500, 95, 37),
            new(1400, 1600, 3150, 3500, 99, 39),
            new(1600, 1800, 3150, 3500, 102, 41),
            new(1800, 2000, 3150, 3500, 103, 41),
            new(2000, 2250, 3150, 3500, 104, 42),
            new(2250, 2500, 3150, 3500, 108, 43),
            new(500, 630, 3500, 4000, 80, 30),
            new(630, 800, 3500, 4000, 89, 34),
            new(800, 1000, 3500, 4000, 92, 36),
            new(1000, 1250, 3500, 4000, 98, 39),
            new(1250, 1400, 3500, 4000, 101, 41),
            new(1400, 1600, 3500, 4000, 104, 42),
            new(1600, 1800, 3500, 4000, 106, 43),
            new(1800, 2000, 3500, 4000, 107, 43),
            new(2000, 2250, 3500, 4000, 110, 47),
            new(2250, 2500, 3500, 4000, 114, 49),
            new(500, 630, 4000, 4500, 95, 37),
            new(630, 800, 4000, 4500, 98, 39),
            new(800, 1000, 4000, 4500, 101, 41),
            new(1000, 1250, 4000, 4500, 105, 45),
            new(1250, 1400, 4000, 4500, 108, 47),
            new(1400, 1600, 4000, 4500, 110, 48),
            new(1600, 1800, 4000, 4500, 113, 50),
            new(1800, 2000, 4000, 4500, 115, 50),
            new(2000, 2250, 4000, 4500, 116, 50),
            new(2250, 2500, 4000, 4500, 119, 51),
            new(630, 800, 4500, 5000, 105, 43),
            new(800, 1000, 4500, 5000, 108, 46),
            new(1000, 1250, 4500, 5000, 112, 48),
            new(1250, 1400, 4500, 5000, 115, 50),
            new(1400, 1600, 4500, 5000, 119, 51),
            new(1600, 1800, 4500, 5000, 120, 52),
            new(1800, 2000, 4500, 5000, 121, 52),
            new(2000, 2250, 4500, 5000, 122, 52),
            new(2250, 2500, 4500, 5000, 125, 53),
        ];

        private static bool Contains(this Deviation deviation, int diameter, int height)
        {
            return diameter >= deviation.MinDiameter
                && diameter <= deviation.MaxDiameter
                && height >= deviation.MinHeight
                && height <= deviation.MaxHeight;
        }
    }
}
